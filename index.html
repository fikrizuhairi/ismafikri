<!doctype html>
<html lang="ms">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>Walimatulurus - Isma & Fikri</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Great+Vibes&display=swap" rel="stylesheet">

<style>
/* ========== MOBILE-FIRST STYLES ========== */
:root{
  --bg: #060607;
  --card: rgba(255,255,255,0.03);
  --accent: #f8d7b6;
  --muted: #cfcfd3;
  --glass: rgba(255,255,255,0.04);
  --radius: 12px;
  --gap: 14px;
  --btn-h: 48px;
  --maxw: 980px;
  --font-sans: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  --font-script: "Great Vibes", cursive;
}

/* Reset */
*{box-sizing:border-box}
html,body{height:100%; margin:0; font-family:var(--font-sans); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
body{background:var(--bg); color:#fff; line-height:1.45;}

/* Container */
.container{width:100%; max-width:var(--maxw); margin:0 auto; padding:18px;}

/* HERO */
.hero{
  min-height:calc(100vh - 24px);
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding-top:28px;
  padding-bottom:28px;
  background-image: linear-gradient(180deg, rgba(0,0,0,0.22), rgba(0,0,0,0.48)), url('assets/hero.jpg');
  background-size:cover;
  background-position:center;
  text-align:left;
}

/* Card (stack on mobile) */
.card{
  width:100%;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius:var(--radius);
  padding:16px;
  box-shadow: 0 6px 22px rgba(0,0,0,0.5);
  display:flex;
  flex-direction:column;
  gap:var(--gap);
  backdrop-filter: blur(4px);
}

/* Top row (text) */
.logo-label{font-size:13px; color:var(--muted); margin-bottom:6px}
.couple{
  font-family:var(--font-script);
  font-size:34px;
  color:#fff;
  margin:2px 0 4px;
  line-height:1.05;
}
.meta{font-size:14px; color:var(--muted)}

/* Countdown */
.countdown{
  display:flex;
  gap:10px;
  margin-top:10px;
  flex-wrap:wrap;
}
.countdown .item{
  min-width:56px;
  padding:10px;
  border-radius:10px;
  background:var(--glass);
  text-align:center;
  display:flex;
  flex-direction:column;
  align-items:center;
}
.countdown .num{font-weight:700; font-size:18px; color:#fff}
.countdown .label{font-size:12px; color:rgba(255,255,255,0.9); margin-top:4px}

/* Actions */
.actions{display:flex; gap:10px; margin-top:12px; flex-wrap:wrap}
.btn{
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
  height:var(--btn-h); padding:0 16px; border-radius:10px; border:0;
  font-weight:600; cursor:pointer; text-decoration:none; color:var(--accent);
  background:transparent; min-width:110px;
}
.btn-primary{
  background:linear-gradient(90deg,#ffcfb0,#ffd4a2); color:#2b1b10;
  box-shadow: 0 8px 22px rgba(0,0,0,0.45);
}
.btn:active{transform:translateY(1px)}

/* Thumbnail */
.thumb{width:100%; height:220px; border-radius:10px; overflow:hidden; background:rgba(255,255,255,0.02)}
.thumb img{width:100%; height:100%; object-fit:cover; display:block}

/* DETAILS section */
.section{padding:18px; display:block}
.card-inner{background:var(--card); border-radius:12px; padding:14px; color:var(--muted)}

/* Map responsive */
.map{width:100%; height:220px; border-radius:10px; overflow:hidden; border:1px solid rgba(255,255,255,0.04); margin-top:10px}
.map iframe{width:100%; height:100%; border:0}

/* Modal */
.modal-backdrop{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:40; background:rgba(0,0,0,0.6); padding:20px}
.modal{width:100%; max-width:680px; background:#0f0f10; border-radius:12px; padding:16px; box-shadow:0 24px 60px rgba(0,0,0,0.65)}
.form-row{display:flex; gap:8px; margin-bottom:12px; flex-wrap:wrap}
.form-row .field{flex:1 1 160px; min-width:120px}
label{display:block; font-size:13px; margin-bottom:6px; color:var(--muted)}
input[type="text"], input[type="email"], textarea, select{width:100%; padding:10px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:transparent; color:#fff}

/* Footer */
.footer{padding:16px; text-align:center; color:var(--muted); font-size:13px;}

/* Larger screens */
@media (min-width:880px){
  .hero{align-items:center; padding:48px 20px}
  .card{flex-direction:row; align-items:center; gap:22px; padding:24px}
  .invite-text{flex:1}
  .thumb{width:240px; height:240px; flex:0 0 240px}
  .couple{font-size:48px}
  .map{height:260px}
  .actions{justify-content:flex-start}
}

/* Accessibility focus */
.btn:focus, a:focus, input:focus, textarea:focus{outline:3px solid rgba(255,220,160,0.12); outline-offset:2px}

/* Utility hidden */
.hidden{display:none !important}
</style>
</head>
<body>

<div class="container">
  <!-- HERO -->
  <section class="hero" id="hero" aria-label="Jemputan utama">
    <div class="card" role="region" aria-label="Kad jemputan">
      <div class="invite-text">
        <div class="logo-label">Dengan nama Allah, kami menjemput anda</div>
        <div class="couple" id="coupleName">Isma & Fikri</div>
        <div class="meta" id="metaText">Sabtu, 03 Januari 2026 ‚Ä¢ White House Event Space, Dungun</div>

        <!-- Countdown -->
        <div class="countdown" id="countdown" aria-live="polite" aria-atomic="true">
          <div class="item" data-unit="days"><span class="num" id="cd-days">00</span><span class="label">Hari</span></div>
          <div class="item" data-unit="hours"><span class="num" id="cd-hours">00</span><span class="label">Jam</span></div>
          <div class="item" data-unit="mins"><span class="num" id="cd-mins">00</span><span class="label">Minit</span></div>
          <div class="item" data-unit="secs"><span class="num" id="cd-secs">00</span><span class="label">Saat</span></div>
        </div>

        <!-- Actions -->
        <div class="actions" role="toolbar" aria-label="Tindakan">
          <button class="btn btn-primary" id="rsvpBtn" aria-haspopup="dialog">RSVP</button>
          <a class="btn" href="#detail" role="button">Butiran Majlis</a>
          <button class="btn hidden" id="playMusicBtn" title="Main / Henti muzik">Main muzik</button>
        </div>
      </div>

      <!-- Thumb image -->
      <div class="thumb" aria-hidden="false">
        <img src="assets/couple.jpg" alt="Pasangan - Isma & Fikri" loading="lazy">
      </div>
    </div>
  </section>

  <!-- DETAILS -->
  <section id="detail" class="section" aria-label="Butiran majlis">
    <div class="card-inner">
      <h3 style="color:#fff; margin-top:0">Aturcara</h3>
      <p><strong>Akad:</strong> 8:00 pagi ‚Äî White House Event Space, Dungun</p>
      <p><strong>Majlis Makan:</strong> 11:00 tengahari ‚Äî White House Event Space, Dungun</p>
      <p>Kami amat menghargai kehadiran anda. Sila sahkan kehadiran melalui borang RSVP.</p>

      <hr style="border:none; height:1px; background:rgba(255,255,255,0.03); margin:14px 0">

      <h4 style="color:#fff">Lokasi</h4>
      <p class="badges"><span class="badge">White House Event Space, Dungun</span></p>

      <div class="map" id="mapWrap" aria-hidden="false">
        <!-- Embed map (search query) -->
        <iframe id="gmap"
          src="https://www.google.com/maps?q=White+House+Event+Space+Dungun&output=embed"
          loading="lazy" referrerpolicy="no-referrer-when-downgrade" aria-label="Peta lokasi"></iframe>

        <div style="text-align:center; margin-top:10px;">
          <a href="https://maps.app.goo.gl/Z2F3c86dVen1ciR29" target="_blank" rel="noopener" class="btn btn-primary" aria-label="Buka lokasi dalam Google Maps">
            üìç Buka dalam Google Maps
          </a>
        </div>
      </div>

      <div class="aside" style="margin-top:12px">
        <div><strong style="color:#fff">Maklumat Tambahan</strong></div>
        <div style="color:var(--muted)">Pakaian: Sopan. Had umur: Semua dialu-alukan.</div>
        <div style="color:var(--muted)"><strong>Hubungi:</strong> +60 12-345 6789 (Isma)</div>
        <div style="margin-top:8px">
          <button class="btn" id="shareBtn">Kongsi Jemputan</button>
        </div>
      </div>
    </div>
  </section>

  <!-- RSVP Modal -->
  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="rsvpTitle">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px">
        <strong id="rsvpTitle" style="font-size:16px">Borang RSVP</strong>
        <button class="btn" id="closeModal" aria-label="Tutup borang">Tutup</button>
      </div>

      <form id="rsvpForm">
        <div class="form-row">
          <div class="field">
            <label for="guestName">Nama</label>
            <input id="guestName" name="name" type="text" placeholder="Nama penuh" required>
          </div>
        </div>

        <div class="form-row">
          <div class="field">
            <label for="guestEmail">Email (pilihan)</label>
            <input id="guestEmail" name="email" type="email" placeholder="contoh@mail.com">
          </div>
          <div class="field">
            <label for="guestPhone">Telefon</label>
            <input id="guestPhone" name="phone" type="text" placeholder="+60 12-345 6789" required>
          </div>
        </div>

        <div class="form-row">
          <div class="field">
            <label for="willAttend">Hadir?</label>
            <select id="willAttend" name="attend" required>
              <option value="yes">Ya, saya akan hadir</option>
              <option value="no">Maaf, tidak dapat hadir</option>
              <option value="maybe">Belum pasti</option>
            </select>
          </div>
        </div>

        <label for="msg">Pesanan / Permintaan</label>
        <textarea id="msg" name="message" placeholder="Ada keperluan khas?"></textarea>

        <div style="margin-top:12px; display:flex; gap:8px; justify-content:flex-end">
          <button type="button" class="btn" id="cancelForm">Batal</button>
          <button type="submit" class="btn btn-primary">Hantar RSVP</button>
        </div>

        <p id="formStatus" style="margin-top:10px; color:var(--muted); font-size:13px"></p>
      </form>
    </div>
  </div>

  <footer class="footer">Terima kasih ‚Äî Kami tak sabar nak berjumpa anda! üå∫</footer>
</div>

<!-- ===== YouTube autoplay (mute) - Option 3 ===== -->
<!-- This will autoplay muted when the page loads (reliable across browsers) -->
<iframe
  width="0"
  height="0"
  src="https://www.youtube.com/embed/JmIUdR_fob0?autoplay=1&mute=1&loop=1&playlist=JmIUdR_fob0"
  frameborder="0"
  allow="autoplay; encrypted-media"
  allowfullscreen>
</iframe>

<script>
/* ================= CONFIG =================
   - Set rsvpEndpoint to your deployed Apps Script Web App URL (or leave empty for mailto fallback)
   - Set rsvpSecret to the secret token you used in Apps Script (must match)
*/
const CONFIG = {
  coupleName: "Isma & Fikri",
  // Countdown target (3 Jan 2026, 08:00 Malaysia time)
  dateISO: "2026-01-03T08:00:00+08:00",
  metaText: "Sabtu, 03 Januari 2026 ‚Ä¢ White House Event Space, Dungun",
  heroImage: "assets/hero.jpg",
  coupleImage: "assets/couple.jpg",
  // If you have deployed Apps Script web app, paste URL here:
  // Example: "https://script.google.com/macros/s/AKfycbx.../exec"
  rsvpEndpoint: "",

  // The secret token (must match SECRET_TOKEN in your Apps Script)
  rsvpSecret: "gembira2026!"
};
/* ========================================= */

document.getElementById('coupleName').textContent = CONFIG.coupleName;
document.getElementById('metaText').textContent = CONFIG.metaText;
document.querySelector('.hero').style.backgroundImage = `linear-gradient(180deg, rgba(0,0,0,0.22), rgba(0,0,0,0.48)), url('${CONFIG.heroImage}')`;
document.querySelector('.thumb img').src = CONFIG.coupleImage;

/* ========== Countdown ========== */
function pad(n){ return String(n).padStart(2,'0'); }
function startCountdown(targetISO){
  const target = new Date(targetISO);
  if(Number.isNaN(target.getTime())){ console.warn('Invalid date:', targetISO); return; }

  const elDays = document.getElementById('cd-days');
  const elHours = document.getElementById('cd-hours');
  const elMins = document.getElementById('cd-mins');
  const elSecs = document.getElementById('cd-secs');
  const container = document.getElementById('countdown');

  function tick(){
    const now = new Date();
    let diff = Math.max(0, target - now);
    if(diff <= 0){
      if(window.innerWidth < 520){
        container.innerHTML = '<strong style="color:#fff">Majlis Bermula!</strong>';
      }else{
        elDays.textContent = '00'; elHours.textContent = '00'; elMins.textContent = '00'; elSecs.textContent = '00';
      }
      clearInterval(intervalId);
      return;
    }
    const totalSec = Math.floor(diff / 1000);
    const days = Math.floor(totalSec / (24 * 3600));
    const remAfterDays = totalSec - (days * 24 * 3600);
    const hours = Math.floor(remAfterDays / 3600);
    const remAfterHours = remAfterDays - (hours * 3600);
    const mins = Math.floor(remAfterHours / 60);
    const secs = remAfterHours - (mins * 60);

    elDays.textContent = pad(days); elHours.textContent = pad(hours);
    elMins.textContent = pad(mins); elSecs.textContent = pad(secs);

    const daysItem = container.querySelector('[data-unit="days"]');
    if(daysItem){
      if(days === 0 && window.innerWidth < 520) daysItem.classList.add('hidden'); else daysItem.classList.remove('hidden');
    }
  }
  tick();
  const intervalId = setInterval(tick, 1000);
  window.addEventListener('resize', tick);
}
startCountdown(CONFIG.dateISO);

/* ========== Modal & RSVP ========== */
const rsvpBtn = document.getElementById('rsvpBtn');
const modal = document.getElementById('modalBackdrop');
const closeModal = document.getElementById('closeModal');
const cancelForm = document.getElementById('cancelForm');
const rsvpForm = document.getElementById('rsvpForm');
const formStatus = document.getElementById('formStatus');

function openModal(){ modal.style.display = 'flex'; modal.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; document.getElementById('guestName').focus(); }
function hideModal(){ modal.style.display = 'none'; modal.setAttribute('aria-hidden','true'); document.body.style.overflow=''; }

rsvpBtn.addEventListener('click', openModal);
closeModal.addEventListener('click', hideModal);
cancelForm.addEventListener('click', hideModal);
modal.addEventListener('click', (e)=>{ if(e.target===modal) hideModal(); });
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') hideModal(); });

/* Form submit: POST to Apps Script if endpoint set; else mailto fallback */
rsvpForm.addEventListener('submit', async (e)=>{
  e.preventDefault();
  formStatus.textContent = "Menghantar...";

  const data = {
    name: rsvpForm.name.value.trim(),
    email: rsvpForm.email.value.trim(),
    phone: rsvpForm.phone.value.trim(),
    attend: rsvpForm.attend.value,
    message: rsvpForm.message.value.trim(),
    timeSubmitted: new Date().toISOString()
  };

  if(CONFIG.rsvpEndpoint){
    try{
      const res = await fetch(CONFIG.rsvpEndpoint, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-rsvp-secret': CONFIG.rsvpSecret
        },
        body: JSON.stringify(data)
      });
      const j = await res.json().catch(()=>({}));
      if(res.ok && (j.ok === true || j.message)){
        formStatus.textContent = "Terima kasih ‚Äî RSVP telah diterima.";
        rsvpForm.reset();
        setTimeout(hideModal,1200);
      } else {
        throw new Error(j.error || 'Pelayan tidak menjawab dengan betul');
      }
    }catch(err){
      console.error(err);
      formStatus.textContent = "Gagal hantar. Sila cuba semula atau hubungi penganjur.";
    }
    return;
  }

  // Mailto fallback
  const subject = encodeURIComponent(`RSVP: ${data.name} ‚Äî ${CONFIG.coupleName}`);
  const body = encodeURIComponent([
    `Nama: ${data.name}`,
    `Email: ${data.email}`,
    `Telefon: ${data.phone}`,
    `Hadir: ${data.attend}`,
    `Pesanan: ${data.message}`,
    `Tarikh Hantar: ${data.timeSubmitted}`
  ].join('\n'));
  window.location.href = `mailto:?subject=${subject}&body=${body}`;
  formStatus.textContent = "Membuka aplikasi e-mel... jika tiada, sila hubungi penganjur.";
});

/* ========== Share ========== */
document.getElementById('shareBtn').addEventListener('click', async ()=>{
  const shareData = {
    title: `${CONFIG.coupleName} - Jemputan`,
    text: `Jemputan perkahwinan: ${CONFIG.coupleName} ‚Äî ${CONFIG.metaText}`,
    url: window.location.href
  };
  if(navigator.share){
    try { await navigator.share(shareData); } catch(e){ /* ignore */ }
  } else {
    await navigator.clipboard.writeText(window.location.href);
    alert('Pautan disalin ke papan klip.');
  }
});
</script>

</body>
</html>
